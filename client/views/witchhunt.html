<head>
	<title>Witchhunt</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
	<h1>Witchhunt</h1>
	{{> loginButtons}}
	{{#if is_admin}}
		<div id="admin-panel">
			<button id="create-game">Create Game</button>
			{{#if is_cpi}}
				<button id="clear-all">Clear All Games</button>
			{{/if}}
			<form class="sandbox">
				<input type="text" name="text" placeholder="user sandbox"/>
			</form>
		</div>
	{{/if}}
	{{> game_list }}
	{{#if is_immersed}}
		{{#each game_selected}}
			{{>game_panel}}
		{{/each}}
	{{/if}}
</body>

<template name="game_list">
	<ul class="games-list">
		{{#each game_dir}}
			{{> game_dir_entry}}
		{{/each}}
	</ul>
</template>

<template name="game_dir_entry">
	<li><p class="game-dir-line">{{description}}</p>
		{{#if can_join}}
			<button class="join-game">Join</button>
		{{/if}}
		{{#if is_in}}
			<button class="immerse">&gt;</button>
		{{/if}}
		{{#if can_leave}}
			<button class="leave-game">Leave</button>
		{{/if}}
		{{#if is_mod}}
			{{#if is_signup}}
				<form class="add-player">
					<input type="text" name="text" placeholder="Add username"/>
				</form>
				<button class="debug-populate-game">Debug Populate</button>
				<button class="setup-game-base">Base Set</button>
				<button class="setup-game-halftime">Halftime</button>
				<button class="advance-game">Advance</button>
			{{/if}}
		{{/if}}
	</li>
</template>

<template name="game_panel">
	<div class="game-panel">
		<button class="back">&lt; Back</button>
		<p>{{description}}</p>
		<p>{{data}}</p>
		{{#each players}}
			{{>player}}
		{{/each}}
		<!--{{#each targets}}
			{{> target}}
		{{/each}}-->
		{{#each log_events}}
			{{> log_event}}
		{{/each}}
	</div>
</template>

<template name="player">
	{{#if is_mod}}
		<p>{{username}} permissions: {{player_permissions}}</p>
	{{else}}
		<div class="cards">
			<div class="card shown top-card">
				<h2>Cards hidden</h2>
				<p>
					Click to reveal cards
				</p>
				<p>
					Keep clicking to cycle through all cards.
				</p>
			</div>
			{{#each player_cards}}
			<div class="card">
			{{>player_card}}
			</div>
			{{/each}}
		</div>
	{{/if}}
</template>

<template name="player_card">
	<img class="player-card" src="{{player_card_uri}}">
</template>

<template name="target">
	<p>
	<span>Target: {{tag}} </span>
	{{#each target_list}}
		{{> target_selector}}
	{{/each}}
	</p>
</template>

<template name="target_selector">
	<select class="target-selector" id="{{index}}" value={{this}}>
		{{#each legal_inputs}}
			{{> target_selector_option}}
		{{/each}}
	</select>
</template>

<template name="target_selector_option">
	<option value={{this}} selected={{selected}}>{{text}}</option>
</template>

<template name="log_event">
	<p>{{log_parse}}</p>
</template>
